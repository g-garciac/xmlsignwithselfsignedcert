using System;
using System.IO;
using System.Xml;
using XMLSignaturePoc;
using Xunit;

namespace XmlSignaturePoc.Tests
{
    public class SigningXmlTests
    {
        [Fact]
        public void Sign()
        {
            var p12B64 = "MIIQKQIBAzCCD+8GCSqGSIb3DQEHAaCCD+AEgg/cMIIP2DCCBg8GCSqGSIb3DQEHBqCCBgAwggX8AgEAMIIF9QYJKoZIhvcNAQcBMBwGCiqGSIb3DQEMAQYwDgQIEmQJOtb6exACAggAgIIFyHAHP1Ggt/eHLUuLdKz7WS2QvdK5MrRVehf42RH7lGKrG7A7wjO3/W1Dn7b8fNfzKx+wEwquSvj27qXdhNp18E1LXsDSzsdAYzGF7RTIBe0ECrEMKUyh2tFJGZzmBbz/sttmdVjigFhJlSknbAC5doUsIm08v7Fa6aiCdGBTAQlHU1r0v4LSB+Rf0L8d2t8l0DV5ZSYFt4s6hujg9pvEUdRuLR3xBxV7vUIcmymS8CH3NrsZpyJaDCpbFuu5UPfex+PaBgl6XLVSn+4yVN4tCTNdU1TJ11y4B+eNE73s4Qfmq6CXuokVpqGaUeOmJ4+eqwdRcLuQmwlSumVdclbt+1JL62Az02K9gJFEoUdw99rqMtaQC6BhD2txZyhSmu7eELM3J4zy6GjZC5azC0LykVLQqYckEQRpMkXs7E7IW31ASC/jZlJuoDTdA+19X/QqfEuNTItJhrPn+6KSwMDJJmNNd0ON+AwbNbLrW2nSz0DYbfvQWreZSopnfBLueXfJRQwgcezcIPCh6VpFzOkg0GTwZdKkmJtxd0zN/0CEF3vZbDXaFLTBzgvqwOUJeBo3kJe/Q3nghVhlVIigSB4q5ORKBrZ3fGTCEYRNG34yP22ILmdarMCQxT8iSEjxbuWd+87HUtgN5Nb/u1kz82w8GQ00LIrz+O+QgZtir9k3xwp0CxRJMt7yCZbCRhOZhUNiAf1IjOHoj9gTfQe27aYIxBJuxmcqYGAC8k+elkLWkA7GPHzhFMnD73MwRMmWuQPqrBlhCzVzNKKGFvlII8CeeQaep6ZptVjweBcswyHdTU5yMt6XZYCb/OYmgZgDPwkW7DWLk6oFAwyuK7+81VXou8qh3szNdKxGhHx8eiH5pXA5SnVNV/zeMGOuJfgwyEm1a5jo88gKJtGRy7ITBytfHKUzNaEVWbg54PJZ+IzM7LotWHqHnygPO2fEzJln8rgTVUfuJbPN02Kdqp9M/luKraUfmLFT8DQjt46GUJdtNpMBYjYxbBqWI3PZXi7e3yg5QWpVeXRO37KPnKR/SYnEqzOL0Z3Rz12guA2aIFF3aUR+bhsS6FAX+kXrl4Tn4dR+32HegOTSVVzpCeoF0anjayqs6GLskbMiJIJEtIWzEVDecPcupzsrGDrONqMcM+7sy+pqjiuGa5TiC0NUX8KDSTHM7bm1I1RyMg77Ip18lqZhyX8B6lHvn68/TPJsvbnC6Z4riu8LM/lxES5jnYoADueywQ2pCjsSNeyjYCkBAfIvkqO0Phj5q+7s+TWZIqnPR4M8AwpdPotIam2alcccAjA35OSCjG93h5j2bivUM4Z65ODAGS55QOFlZCF5+AavIynsIXCstLbIU6R/xN4vYv0Ffkd88r/jLug/p7YuFDGySinC9QaJcyVk0kJjanDDRiEDj+lHNH5VKZ3jlGqisujWC/ZPbxhH202GuqeXeaPMJMXXfdxLq3opmwNBeY87o8KuqP8LgG1FZnNfdcrXNd1yBJblbb12Hp+88kRcCcRbNuExSxO0w78tUzuV01OFP7E3n15maPGTl0En6pf5eyb/nkMBsNtboXyLzmhPcT3d+5afpuZEExBuwe8QS+9UekI/Pi0MhhN0iyhi1s8yGQL516RCZkRokPrGa4lpU2cpEk2Spt+nwmH8qf5fAmFjfl0asSy9rk6N1MVGiCaotlkipbJTitW3yV+Lac2A9ViRT2LPwc4e5msGUV2L9hFiLMUn/NyAFN7GW/oX32KaCbJp09T8c+4q/sZt0ecYHBn/EFoNKNA/+tL5mDSLdZKoTI5h1TY4cTqiIvriXsHevzvNYoz1AgbJuKTlcO8GHPb1pnmSPipI7XZrhwVriEyTkrHYaEKBRGDyjlpnCuSYVOGZABth2PGs8w3xXFuHBfEhYONq2xhGkvfbh7KY2MUoLKtQVtCqHqoEo7iUHD/veRJFsrKBC3SyOZRbk6Gx1T6kyU1Kq2QVqlUwggnBBgkqhkiG9w0BBwGgggmyBIIJrjCCCaowggmmBgsqhkiG9w0BDAoBAqCCCW4wgglqMBwGCiqGSIb3DQEMAQMwDgQIGfRfIpFeFwACAggABIIJSAE0fC5sxcLHFL2Nf/c00OkRJzKvkxd0IsBzOZkjfYChBFF1c4IOdFNClhJ2UyySicwTqTWnN38KHiP+JGo1YYVeN/l35d2QPuX1NWkfF1yigJYTZY4YECoxRojFdhUEdwQlKpwSBxthFGXV0fQ3uyzxRYAKuJolJLfDIVZc5hR6ONLUi7cp/uir5P8IaOv7PgOxZIDO7foNY9fiIMHQJ44aqlJnory3uvRS6fTW5y6X3noiqEnq4AkVkqeI1fvQuamu2cO9SuXPLnmVBmP+tYI+B05uwhSMyq2RILTWCLkMI0DxTHcWmvzSAOCxksPbHxRbvnbz9yPncfXkci0kSFm5czcimslIlgM28V6pvlV6H+hEfSfWtO+p5cF8QrkSWJL1DKzv/NGvCh6/30u1y9os4YqEzi2/lQ71eowiWfGftJvcxsTWYjRyotFSKYNLfcEyr7sHcXrytXuZzi4rVd4rs/MEyTtnq3CQ/y5rqSE8ZjSi2eMvqfpxgbR+HfEXkTaQFqIeNgp6NP1o7LKB5vFtZIkWckNgMkS2bFHNk/k4OKvWlMo/LytY2tNFGVelVlRlzu4hJbPw3nDVSxjYKcGpqqt7sSNiOVn2Dp+pL2sufvflcC9QUn/PBTq99dNixCzmJiZcs1T6NxzJZbqThd6cZaZXzvLjXl/HQJyppahSLBJGsmaGvK3ozAm5BZDVurkqfgeaHdRVhFdzQZFuefucHMckBDoaCq5eUq1EaPTIAwlQqqg1kjeAE7ofTIhf87+fFBRaRLgwXvs88K2dtKgR7RSf+E3rpJkFWVIVDJJvl3xHeK8SdLGai20Fg8WcGkLNLzSY0qqyddVpxylJ0vEymHK7ZnLxC2oLRDnfxa7789qR9lIsIZuKwm4in3WA4w/ZF0sqK4sfBONtxmaYOXz6/OD99otn58g+bMRRYMeTfS7XnQxcT6p3Ze41imDZHZr5rmWr9jNUKbJC21zSaOLKCrjUSxM2jrkfN5SBJzu3ybLZXvqC71tghXbavGFgpXlBPa5iPrynA9E04WZiUtTHodnbZsmrHgY32Vanh0KCfjHVicO5oqRENba6cDR9fHdaBOzffxjy0++VC6Mu41Lec3CIcYzFt/0DmdibXUuWI8LQ1wAVVNv3om/cVDqqlKYLJMcb/a2xCLuMsy6JYeaNQ6DZJslhpmGtjy72FnRXify5CZYIlnlYR3xusqP3OhpFwatpsOu2fMs99Zj4iAkj/tJ64XDhh6aoj68/N1kDYRi8mMaZHGipAjg0TNldTh2xk05N5j1DCPwdFV+qUMQZqIq1XYEvJ2x2YXf8pd/cZOqfhJZaiukY5nqbkGbktvbqQ/78oU8eHq0nuFqzGS+9pFPD0gW4E2hMQRehjm6FFgeodk+f9LKaDfxPcWQDtQQD4T8+fRyighs3oVCQ+4KnFz1YBqhSm3irEHhGZNM41bEox0bjRZRFgBB0OrHB3SnZDiV9aUFxk7lTSqfgmuT9PoqrWCJbPkcYqxIbQJo+m9gVS8NaJLwkwsK+5oCMUik5wABy6bMap7n5p/Kphlm+KKbW6ws0ahEsETS3ftE78r6yE5O6rGQNLBCBr4Ux8XlCboJySfl2zcZXgLJs38g2tQ2GMpjsZgMBjKqGKEJJ2uNlTId1pun8zKwBsrBPQIYPovdxpFm1gr52F7rfHIeJrRPBUjgK3KEQMcminTY0GLtkiHSsnOhL7D5or8pVq5u951iY/7TYuF/RO6GLDpYJUW9mQvdeDtxIBX8YexSU5I6ZiHnKPFEeOyOBpef5Ym1mDn3TBKaDQuYc1I+SuFgZq/J9Nk9QeVI+AvxUD0jgi4CYpXzoL/4fun1kdvBa4oZ6GSDdDOyTjFEZHvs1YZC29WWn8XA1a+j9FMRlzOf55DUaEXD3ykQWRoza6PEm49zU01Ku+ajoZZ0BjcQnBxkC25vrLhWjsqAGSYi/8pTxDLzkDdmH69hdaSYJCalot5+8DGXWDZ3UVDTt8iUFpDNyMp142P9tT3cA0VoyEAqThCul5ZuAZP+Xv8sg/f0SE1/g49lvHqa/QFT2vBiNdj0+lInW7CTb0HhffWxLiMLeUK8IooFoLSZfVHO9mnsQ+ou0Jl8tietZmfYoNjyvM+yaH9aueuzPXyAgFnkaQd7krew1w1BBmMakij5gpTzojr07+WKqBM+jX3P3e80Zz5YFIR2+Bz3I201GO7rjiDqhsZuopehIjXjPHCGBb9qNwGGsl4tYRJRXNdKjp+ConYu8MGj79Is5DkewD/wSd9z9QSJy3L3eZHTAA83aJykafYQWAlMIdXr4jnadiJt0qXCY68Z/htsqDG1yq+wH1NUXwDl3bAg0mKDrarGyV/bRO8hggd/pWVnLRkV4TdLf/+O6negi88KglBvyV+wL5r4MO78pSAmO1968jD2ygW9PaFYNyTx45NDYkalO0knqboTO7PEmmjyMMywbm3EFG/2Lt7bYkzYaKC44DZ8f7ApTTvce+ibq7b8Y4yryA2XRkcngIE5bK3uEtD3IMt1F0XrDyukuxOLATDRYQjJLCn+4KKhoupHB65nR2fqsoIMgFjfTm9+j3JlBbCONNwYv4jxrdytNzwo2vdawI1w80eRP9IKI3WnzI4ID9Q2G37+J0dt1uWGklKBd7U5Zwk6xyeI2Quof+BFpDdfip4rmnwmtE692zcD36fkAR1J9qxtFkPasY0QEEmzYbSJbkzLHEBla6g9bVrFIZuyIHnnjq338w1FsVN5W+hawndGDU4BKn3kl3lLyAAmTD1blW1ZTd5mnpSWbu3xtJ+4Dd32gEzNsxGRCz8qzXMV8parWegtF9CHFmjnGR4luSVGkCHaLNAZJ8RyKiNIJlSyqtMliDbP3F2xKpAIKPkU96JIN1KCsHMG510snuf3W8CM7gSP28oX4EcwTUtISp8UM3BD2RCS7V4uBhoarvoYezfib03H0m7cODI9gtJQp6cPHmJ5kvjJ1pdzMc1Zlx87IXTr0qQ4+17gl0Bvbr5JvshHqI8gt+iAOHPfDjaXg2qZrc5eP5xAd8ApxD+bBsZBN0BxZGq+BX+fLZgS+um1lG6mdAnp7kyWpB4RLJDoh07fhAICasNOGtn0pWxsqE3i8ejEUDxt3mMRRtn9AK4JmsZIJ54k7Yk3M7Jn9phmwbzElMCMGCSqGSIb3DQEJFTEWBBSCvhhIkEbhY5PQfUcGnqPianTNtTAxMCEwCQYFKw4DAhoFAAQUHoNvIbN2Ssa6fW05rOXhi62C788ECCpNx4TFb7X7AgIIAA==";
            var p12Bin = Convert.FromBase64String(p12B64);
            var xmlDoc = new XmlDocument();
            xmlDoc.LoadXml("<prueba nombre='Prueba 01'></prueba>");

            var xmlWithSignature = SigningXml.Sign(xmlDoc, p12Bin, "Pa$$w0rd");

            Assert.NotNull(xmlWithSignature);
        }
    }
}
